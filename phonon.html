
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Lattice vibration &#8212; spgrep-modulation 0.2.4</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Isotropy subgroup" href="isotropy_subgroup.html" />
    <link rel="prev" title="Formulation" href="formulation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">spgrep-modulation 0.2.4</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="examples.html">
   Examples
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="examples/band_connectivity.html">
     Sewing band structure by subduced representation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="examples/visualize.html">
     Visualize modulated structures with nglview
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="formulation.html">
   Formulation
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Lattice vibration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="isotropy_subgroup.html">
     Isotropy subgroup
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api.html">
   API reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="api_modulation.html">
     Modulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api_irreps.html">
     Irreps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api_isotropy.html">
     Isotropy subgroup
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="changelog.html">
   Change log
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="notes.html">
   Implementation notes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="group_velocity.html">
     Symmetry condition for group velocity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="supercell.html">
     Supercell construction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="band_connectivity.html">
     Band connectivity
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/phonon.md.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#harmonic-phonon">
   Harmonic phonon
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#normal-coordinates">
   Normal coordinates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#action-on-displacements">
   Action on displacements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#small-representation-of-mathcal-g-mathbf-q">
   Small representation of
   <span class="math notranslate nohighlight">
    \(\mathcal{G}^{\mathbf{q}}\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solve-dynamical-matrix-w-r-t-modified-eigenvectors">
   Solve dynamical matrix w.r.t. modified eigenvectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modulation">
   Modulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Lattice vibration</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#harmonic-phonon">
   Harmonic phonon
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#normal-coordinates">
   Normal coordinates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#action-on-displacements">
   Action on displacements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#small-representation-of-mathcal-g-mathbf-q">
   Small representation of
   <span class="math notranslate nohighlight">
    \(\mathcal{G}^{\mathbf{q}}\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solve-dynamical-matrix-w-r-t-modified-eigenvectors">
   Solve dynamical matrix w.r.t. modified eigenvectors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modulation">
   Modulation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="lattice-vibration">
<h1>Lattice vibration<a class="headerlink" href="#lattice-vibration" title="Permalink to this headline">#</a></h1>
<section id="harmonic-phonon">
<h2>Harmonic phonon<a class="headerlink" href="#harmonic-phonon" title="Permalink to this headline">#</a></h2>
<p>Hamiltonian and commutation relations:</p>
<div class="math notranslate nohighlight">
\[  H = \sum_{ l \kappa \mu } \frac{ p_{\mu}(l\kappa)^{2} }{ 2 M_{\kappa} }
    + \frac{1}{2} \sum_{ l \kappa \mu } \sum_{ l' \kappa' \mu' } \Phi_{ \mu \mu' }(l\kappa, l'\kappa') u_{\mu}(l\kappa) u_{\mu'}(l'\kappa')\]</div>
<p>Dynamical matrix <a class="footnote-reference brackets" href="#dynamical-matrix" id="id1">1</a></p>
<div class="math notranslate nohighlight">
\[  D_{\mu \mu'}(\kappa\kappa'; \mathbf{q})
    = \frac{1}{ \sqrt{ M_{\kappa} M_{\kappa'} } } \sum_{l'} \Phi_{ \mu \mu' }(0\kappa, l'\kappa') e^{i \mathbf{q} \cdot ( \mathbf{r}(l'\kappa') - \mathbf{r}(0\kappa) )}\]</div>
<p>We denote <span class="math notranslate nohighlight">\([\mathbf{D}(\mathbf{q})]_{\kappa\mu, \kappa'\mu'} = D_{\mu \mu'}(\kappa\kappa'; \mathbf{q})\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{D}(-\mathbf{q}) &amp;= \mathbf{D}(\mathbf{q})^{\ast} \\
  \mathbf{D}(\mathbf{q})^{\dagger} &amp;= \mathbf{D}(\mathbf{q}) \quad \mbox{(Hermite)}.\end{split}\]</div>
<p>Here we use <span class="math notranslate nohighlight">\(\Phi_{ \mu' \mu }(0\kappa', -l\kappa) = \Phi_{ \mu \mu' }(0\kappa, l'\kappa')\)</span>.</p>
<p>Let normalized eigenvector of <span class="math notranslate nohighlight">\(\mathbf{D}(\mathbf{q})\)</span> as <span class="math notranslate nohighlight">\([\mathbf{e}(\mathbf{q}\nu)]_{\kappa\mu} = e_{\mu}(\kappa; \mathbf{q}\nu)\)</span> with</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{D}(\mathbf{q}) \mathbf{e}(\mathbf{q}\nu)
    &amp;= \omega_{\mathbf{q}\nu}^{2} \mathbf{e}(\mathbf{q}\nu)
    \quad (\nu = 1, \dots, 3N) \\
  \omega_{-\mathbf{q}\nu}^{2} &amp;= \omega_{\mathbf{q}\nu}^{2}.\end{split}\]</div>
<p>We can choose as</p>
<div class="math notranslate nohighlight">
\[  e_{\mu}(\kappa; -\mathbf{q}\nu) = e_{\mu}(\kappa; \mathbf{q}\nu)^{\ast}.\]</div>
<p>Later we denote <span class="math notranslate nohighlight">\(q = (\mathbf{q}, \nu)\)</span> and <span class="math notranslate nohighlight">\(-q = (-\mathbf{q}, \nu)\)</span>.</p>
</section>
<section id="normal-coordinates">
<h2>Normal coordinates<a class="headerlink" href="#normal-coordinates" title="Permalink to this headline">#</a></h2>
<div class="math notranslate nohighlight">
\[\begin{split}  u_{\mu}(l\kappa)
    &amp;=: \frac{1}{\sqrt{ L^{3} M_{\kappa} }} \sum_{q} Q_{q} e_{\mu}(\kappa; q) e^{i \mathbf{q} \cdot \mathbf{r}(l\kappa)} \\
  p_{\mu}(l\kappa)
    &amp;=: \sqrt{\frac{M_{\kappa}}{L^{3}}} \sum_{q} P_{q} e_{\mu}(\kappa; -q) e^{-i \mathbf{q} \cdot \mathbf{r}(l\kappa)} \\
  Q_{q}
    &amp;= \sum_{ l\kappa\mu } \sqrt{ \frac{M_{\kappa}}{L^{3}} } u_{\mu}(l\kappa) e_{\mu}(\kappa; -q) e^{-i \mathbf{q} \cdot \mathbf{r}(l\kappa)} \\
  P_{q}
    &amp;= \sum_{ l\kappa\mu } \frac{1}{\sqrt{ L^{3}M_{\kappa} }} p_{\mu}(l\kappa) e_{\mu}(\kappa; q) e^{i \mathbf{q} \cdot \mathbf{r}(l\kappa)} \\
  Q_{-q} &amp;= Q_{q}^{\ast} \\
  P_{-q} &amp;= P_{q}^{\ast} \\
  H &amp;= \frac{1}{2} \sum_{q} \left( P_{q} P_{-q} + \omega_{q}^{2} Q_{q} Q_{-q} \right) \\\end{split}\]</div>
<p>Creation and annihilation operators</p>
<div class="math notranslate nohighlight">
\[\begin{split}  A_{q}
    &amp;:= \frac{1}{\sqrt{2\hbar\omega_{q}}} \left( \omega_{q} Q_{q} + i P_{-q} \right) \\
  A_{q}^{\dagger}
    &amp;:= \frac{1}{\sqrt{2\hbar\omega_{q}}} \left( \omega_{q} Q_{-q} - i P_{q} \right) \\
  Q_{q}
    &amp;= \sqrt{\frac{\hbar}{2\omega_{q}}} \left( A_{q} + A_{-q}^{\dagger} \right) \\
  P_{q}
    &amp;= i \sqrt{\frac{\hbar\omega_{q}}{2}} \left( A_{-q}^{\dagger} - A_{q} \right) \\
  \left[ A_{q}, A_{q'}^{\dagger} \right] &amp;= \delta_{qq'} \\
  \left[ A_{q}, A_{q'} \right] &amp;= 0 \\
  \left[ A_{q}^{\dagger}, A_{q'}^{\dagger} \right] &amp;= 0 \\
  H &amp;= \frac{1}{2} \sum_{q} \hbar \omega_{q} \left( A_{q}^{\dagger}A_{q} + \frac{1}{2} \right)\end{split}\]</div>
<p>In canonical ensemble:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \langle A_{q}^{\dagger}A_{q} \rangle_{\beta}
    &amp;= \frac{1}{ e^{\beta \hbar \omega_{q}} - 1 } \\
  \langle |Q_{q}|^{2} \rangle_{\beta}
    &amp;= \frac{\hbar}{2\omega_{q}} \left( 2 \langle A_{q}^{\dagger}A_{q} \rangle_{\beta} + 1 \right)\end{split}\]</div>
</section>
<section id="action-on-displacements">
<h2>Action on displacements<a class="headerlink" href="#action-on-displacements" title="Permalink to this headline">#</a></h2>
<p>We define left group action for positions <span class="math notranslate nohighlight">\(\mathbf{r}(l\kappa) = \mathbf{r}(l) + \mathbf{r}(0\kappa)\)</span> by <span class="math notranslate nohighlight">\(g = (\mathbf{R}_{g}, \mathbf{\tau}_{g}) \in \mathcal{G}\)</span> as</p>
<div class="math notranslate nohighlight">
\[  g \mathbf{r}(l\kappa)
    := \mathbf{R}_{g} \mathbf{r}(l\kappa) + \mathbf{\tau}_{g}.\]</div>
<p>We denote that site <span class="math notranslate nohighlight">\(\mathbf{r}(0, \kappa)\)</span> is transformed to <span class="math notranslate nohighlight">\(\mathbf{r}(0, g \kappa ) + \mathbf{h}_{g}(\kappa)\)</span> by symmetry operation <span class="math notranslate nohighlight">\(g\)</span>.
Then,</p>
<div class="math notranslate nohighlight">
\[\begin{split}    g \mathbf{r}(\mathbf{l}, \kappa) &amp;= \mathbf{R}_{g} \mathbf{r}(l) + \mathbf{r}(0, g\kappa) + \mathbf{h}_{g}(\kappa) \\\end{split}\]</div>
<p>We define left group action for displacement at <span class="math notranslate nohighlight">\(\mathbf{r}(l\kappa)\)</span> as <a class="footnote-reference brackets" href="#displacement-action" id="id2">2</a></p>
<div class="math notranslate nohighlight">
\[  g u_{\mu}(\mathbf{r}(l\kappa))
    := \sum_{\nu} [\mathbf{R}_{g}]_{\mu\nu} u_{\nu}(g \mathbf{r}(l\kappa)).\]</div>
<p>Consider Fourier transformation of <span class="math notranslate nohighlight">\(\mathbf{u}(\mathbf{r}(l\kappa))\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{u}(\kappa; \mathbf{q})
    &amp;:= \sqrt{\frac{M_{\kappa}}{L^{3}}} \sum_{l} \mathbf{u}(\mathbf{r}(l\kappa)) e^{ i \mathbf{q} \cdot \mathbf{r}(l) } \\
  \mathbf{u}(\mathbf{r}(l\kappa))
    &amp;= \frac{1}{\sqrt{M_{\kappa}L^{3}}} \sum_{\mathbf{q}} \mathbf{u}(\kappa; \mathbf{q}) e^{ -i \mathbf{q} \cdot \mathbf{r}(l) } \\
  g u_{\mu}(\kappa; \mathbf{q})
    &amp;= \sqrt{\frac{M_{\kappa}}{L^{3}}} \sum_{l} g u_{\mu}(\mathbf{r}(l\kappa)) e^{i \mathbf{q}\cdot \mathbf{r}(l)} \\
    &amp;= \sqrt{\frac{M_{\kappa}}{L^{3}}} \sum_{l}\sum_{\nu}
      R_{g,\mu\nu} u_{\nu}\left( \mathbf{R}_{g}\mathbf{r}(l) + \mathbf{r}(0, g\kappa) + \mathbf{h}_{g}(\kappa) \right)
      e^{i \mathbf{q}\cdot \mathbf{r}(l)} \\
      &amp;\quad (\mathbf{r}(l') := \mathbf{R}_{g}\mathbf{r}(l) + \mathbf{h}_{g}(\kappa) ) \\
    &amp;= \sqrt{\frac{M_{\kappa}}{L^{3}}} \sum_{l'}\sum_{\nu} R_{g,\mu\nu} u_{\nu}\left( \mathbf{r}(l', g\kappa) \right) e^{i \mathbf{q}\cdot \mathbf{R}_{g}^{-1}(\mathbf{r}(l') - \mathbf{h}_{\kappa} ) } \\
    &amp;= \sqrt{\frac{M_{\kappa}}{L^{3}}} \sum_{l'}\sum_{\nu} R_{g,\mu\nu} u_{\nu}\left( \mathbf{r}(l', g\kappa) \right) e^{i \mathbf{R}_{g}\mathbf{q}\cdot (\mathbf{r}(l') - \mathbf{h}_{\kappa} ) }
        \quad (\because \mathbf{R}_{g} \in O(3)) \\
    &amp;= \sum_{\kappa'\mu'} u_{\mu'}(\kappa'; \mathbf{R}_{g} \mathbf{q} ) \Gamma_{\kappa'\mu'; \kappa\mu}^{\mathbf{q}}(g)
      \quad (\because M_{g\kappa} = M_{\kappa}),\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-dynamical-matrix-rep">
<span class="eqno">(1)<a class="headerlink" href="#equation-dynamical-matrix-rep" title="Permalink to this equation">#</a></span>\[\begin{split}  \Gamma_{\kappa'\mu'; \kappa\mu}^{\mathbf{q}}(g)
    &amp;:= \exp \left( -i \mathbf{R}_{g} \mathbf{q} \cdot \mathbf{h}_{g}(\kappa) \right) [\mathbf{R}_{g}]_{\mu'\mu} \delta_{ g\kappa, \kappa' } \\
    &amp;:= \exp \left( -2 \pi i \mathbf{R}_{g, f}^{\top} \mathbf{q}_{f} \cdot \mathbf{h}_{g, f}(\kappa) \right) [\mathbf{R}_{g}]_{\mu'\mu} \delta_{ g\kappa, \kappa' } \\
    &amp;\quad (
      \mathbf{R}_{g, f} := \mathbf{A}^{-1} \mathbf{R}_{g} \mathbf{A},
      \mathbf{q} =: 2\pi \mathbf{A}^{-\top} \mathbf{q}_{f},
      \mathbf{v} =: \mathbf{A} \mathbf{v}_{f}
    )\end{split}\]</div>
<p>Equation <a class="reference internal" href="#equation-dynamical-matrix-rep">(1)</a> is essentially the same with Eq. (2.37) of <span id="id3">[<a class="reference internal" href="#id8" title="A. A. MARADUDIN and S. H. VOSKO. Symmetry properties of the normal vibrations of a crystal. Rev. Mod. Phys., 40:1–37, Jan 1968. URL: https://link.aps.org/doi/10.1103/RevModPhys.40.1, doi:10.1103/RevModPhys.40.1.">MV68</a>]</span>.</p>
<p>We write matrix representation <span class="math notranslate nohighlight">\([\mathbf{\Gamma}^{\mathbf{q}}(g)]_{ \kappa'\mu'; \kappa\mu } := \Gamma_{\kappa'\mu'; \kappa\mu}^{\mathbf{q}}(g)\)</span>.
Then,</p>
<div class="math notranslate nohighlight">
\[\begin{split}    \left[ \mathbf{\Gamma}^{ \mathbf{q}}(gg') \right]_{ \kappa'\mu', \kappa\mu }
    &amp;= \delta_{gg'\kappa, \kappa'} R_{gg', \mu'\mu} \exp \left( -i \mathbf{R}_{gg'}\mathbf{q} \cdot \mathbf{h}_{gg'}(\kappa) \right) \\
    &amp;= \sum_{ \kappa''\nu }
        \delta_{g\kappa'', \kappa'} \delta_{g'\kappa, \kappa''}
        R_{g, \mu'\nu} R_{g', \nu\mu}
        \exp \left( -i \mathbf{R}_{g'}\mathbf{q} \cdot \mathbf{h}_{g'}(\kappa) \right)
        \exp \left( -i \mathbf{R}_{g}\mathbf{R}_{g'}\mathbf{q} \cdot \mathbf{h}_{g}(g\kappa') \right) \\
    &amp;= \left[ \mathbf{\Gamma}^{ \mathbf{R}_{g'} \mathbf{q}}(g) \mathbf{\Gamma}^{ \mathbf{q}}(g') \right]_{ \kappa'\mu', \kappa\mu } \\
  \mathbf{\Gamma}^{\mathbf{q}}(g)^{\dagger} \mathbf{\Gamma}^{ \mathbf{q}}(g)
    &amp;= \mathbf{1} \quad \mbox{(Unitary)} \\
  \Gamma^{\mathbf{q}}((E, \mathbf{t}))_{ \kappa'\mu', \kappa\mu }
    &amp;= \exp \left( -i \mathbf{q} \cdot \mathbf{t} \right) \delta_{\mu'\mu} \delta_{ \kappa, \kappa' }.\end{split}\]</div>
<p>Fourier transformation of force constants</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \Phi_{\mu\mu'}(\kappa\kappa'; \mathbf{q})
    &amp;:= \frac{1}{\sqrt{M_{\kappa}M_{\kappa'}}} \sum_{l'} \Phi_{\mu\mu'}(0\kappa; l'\kappa') e^{ i \mathbf{q} \cdot \mathbf{r}(l') } \\
  \sum_{ l l' } \Phi_{ \mu \mu' }(l\kappa, l'\kappa') u_{\mu}(l\kappa) u_{\mu'}(l'\kappa')
    &amp;= \sum_{\mathbf{q}} \Phi_{\mu\mu'}(\kappa\kappa'; \mathbf{q}) u_{\mu}(\kappa; \mathbf{q}) u_{\mu'}(\kappa'; -\mathbf{q}) \\\end{split}\]</div>
<p>The condition that potential energy is invariant under symmetry operations is rewritten as <a class="footnote-reference brackets" href="#fourier-force-constant" id="id4">3</a></p>
<div class="math notranslate nohighlight">
\[  \mathbf{\Phi}(\mathbf{R}_{g} \mathbf{q})
    = \mathbf{\Gamma}^{\mathbf{q}}(g) \mathbf{\Phi}(\mathbf{q}) \mathbf{\Gamma}^{\mathbf{q}}(g)^{\dagger}.\]</div>
</section>
<section id="small-representation-of-mathcal-g-mathbf-q">
<h2>Small representation of <span class="math notranslate nohighlight">\(\mathcal{G}^{\mathbf{q}}\)</span><a class="headerlink" href="#small-representation-of-mathcal-g-mathbf-q" title="Permalink to this headline">#</a></h2>
<p>For <span class="math notranslate nohighlight">\(h, h' \in \mathcal{G}^{\mathbf{q}}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{\Gamma}^{ \mathbf{q}}(h) \mathbf{\Gamma}^{ \mathbf{q}}(h')
    &amp;= \mathbf{\Gamma}^{ \mathbf{q}}(hh') \\
  \mathbf{\Phi}(\mathbf{q})
    &amp;= \mathbf{\Gamma}^{\mathbf{q}}(h) \mathbf{\Phi}(\mathbf{q}) \mathbf{\Gamma}^{\mathbf{q}}(h)^{\dagger}
    \quad (\forall h \in \mathcal{G}^{\mathbf{q}}).\end{split}\]</div>
<p>We can introduce projective representation <span class="math notranslate nohighlight">\(\overline{\Gamma}^{ \mathbf{q}}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{\Gamma}^{ \mathbf{q}}(h)
    &amp;=: e^{ -i \mathbf{q} \cdot \mathbf{v}_{h} } \overline{\mathbf{\Gamma}}^{ \mathbf{q}}(h) \\
  \overline{\mathbf{\Gamma}}^{ \mathbf{q}}(h) \overline{\mathbf{\Gamma}}^{ \mathbf{q}}(h')
    &amp;= e^{ -i \mathbf{q} \cdot ( \mathbf{R}_{h} \mathbf{v}_{h'} - \mathbf{v}_{h'} ) } \overline{\mathbf{\Gamma}}^{ \mathbf{q}}(hh') \\
  \overline{\mathbf{\Gamma}}^{ \mathbf{q}}((E, \mathbf{t}))
    &amp;= \mathbf{1}\end{split}\]</div>
<p>Thus, we only need to consider projective representation <span class="math notranslate nohighlight">\(\overline{\mathbf{\Gamma}}^{ \mathbf{q}}\)</span> for little co-group <span class="math notranslate nohighlight">\(\overline{\mathcal{G}}^{\mathbf{q}} \simeq \mathcal{G}^{\mathbf{q}} / \mathcal{T}\)</span>.
The decomposition of the projective representation</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \overline{\Gamma}^{\mathbf{q}} &amp;= \sum_{\alpha} \sum_{\sigma} \overline{\Gamma}^{\mathbf{q}\alpha\sigma} \\\end{split}\]</div>
<p>can be performed with <a class="reference external" href="https://github.com/spglib/spgrep">spgrep</a>, where <span class="math notranslate nohighlight">\(\alpha\)</span> represent irrep and <span class="math notranslate nohighlight">\(\sigma = 1,\dots, m_{\alpha}\)</span> distinguish equivalent irreps to <span class="math notranslate nohighlight">\(\alpha\)</span>.
The corresponding small representation of <span class="math notranslate nohighlight">\(\mathcal{G}^{\mathbf{q}}\)</span> is obtained by <span class="math notranslate nohighlight">\(\mathbf{\Gamma}^{ \mathbf{q}\omega}(h) := e^{ -i \mathbf{q} \cdot \mathbf{v}_{h} } \overline{\mathbf{\Gamma}}^{ \mathbf{q}\omega }(h)\)</span>.
We call orthonormal basis vectors <span class="math notranslate nohighlight">\(f_{\mu}(\kappa; \mathbf{q}\alpha\sigma\nu)\)</span> forming irrep <span class="math notranslate nohighlight">\(\Gamma^{\mathbf{q}\alpha}\)</span> as <em>modified eigenvectors</em>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  h f_{\mu}(\kappa; \mathbf{q}\alpha\sigma\nu)
    &amp;= \sum_{\nu'} f_{\mu}(\kappa; \mathbf{q}\alpha\sigma\nu') \Gamma^{\mathbf{q}\alpha}(h)_{\nu',\nu}
    \quad (h \in \mathcal{G}^{\mathbf{q}}, \nu = 1, \dots, d_{\alpha}) \\
  \sum_{\kappa\mu} f_{\mu}(\kappa; \mathbf{q}\alpha\sigma\nu)^{\ast} f_{\mu}(\kappa; \mathbf{q}\alpha\sigma\nu')
    &amp;= \delta_{\nu\nu'}
    \quad (\nu, \nu' = 1, \dots, d_{\alpha})\end{split}\]</div>
<p>We can subdivide eigenvectors further by decomposing <span class="math notranslate nohighlight">\(\Gamma^{\mathbf{q}}\)</span> into irreps,</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \left[ F^{\mathbf{q}\alpha\sigma} \right]_{\kappa\mu, \nu}
    &amp;:= f_{\mu}(\kappa; \mathbf{q}\alpha\sigma\nu) \\
  \mathbf{F}^{\mathbf{q}\alpha\sigma \dagger} \mathbf{\Gamma}^{\mathbf{q}}(h) \mathbf{F}^{\mathbf{q}\alpha\sigma}
    &amp;= \mathbf{\Gamma}^{\mathbf{q}\alpha}(h)
    \quad (h \in \mathcal{G}^{\mathbf{q}}) \\\end{split}\]</div>
</section>
<section id="solve-dynamical-matrix-w-r-t-modified-eigenvectors">
<h2>Solve dynamical matrix w.r.t. modified eigenvectors<a class="headerlink" href="#solve-dynamical-matrix-w-r-t-modified-eigenvectors" title="Permalink to this headline">#</a></h2>
<p>Block-diagonalize fourier transformed force constants:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{F}^{\mathbf{q}\alpha}
    &amp;:= \left( \mathbf{F}^{\mathbf{q}\alpha 1} \dots \mathbf{F}^{\mathbf{q}\alpha m_{\alpha}} \right)
    \quad \in \mathbb{C}^{3N \times m_{\alpha}d_{\alpha}} \\
  \mathbf{\Phi}(\mathbf{q}\alpha)
    &amp;:= \mathbf{F}^{\mathbf{q}\alpha \dagger} \mathbf{\Phi}(\mathbf{q}) \mathbf{F}^{\mathbf{q}\alpha}
    \quad \in \mathbb{C}^{ m_{\alpha}d_{\alpha} \times m_{\alpha}d_{\alpha} }, \\\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\Phi}(\mathbf{q}\alpha)\)</span> is hermitian.</p>
<p>Diagonalize <span class="math notranslate nohighlight">\(\mathbf{\Phi}(\mathbf{q}\alpha)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}  \sum_{\sigma' \nu'} \Phi(\mathbf{q}\alpha)_{\sigma\nu, \sigma'\nu'} c(\mathbf{q} \alpha s\lambda)_{\sigma' \nu'}
    &amp;= \omega_{\alpha s}^{2} c(\mathbf{q} \alpha s\lambda)_{\sigma \nu}
    \quad (s = 1, \dots, m_{\alpha}, \lambda = 1, \dots, d_{\alpha}) \\
  \sum_{\sigma\nu} c(\mathbf{q}\alpha s\lambda)_{\sigma\nu}^{\ast} c(\mathbf{q}\alpha s'\lambda')_{\sigma\nu}
    &amp;= \delta_{s s'} \delta_{\lambda \lambda'} \\
  \sum_{s\lambda} c(\mathbf{q}\alpha s\lambda)_{\sigma\nu}^{\ast} c(\mathbf{q}\alpha s\lambda)_{\sigma'\nu'}
    &amp;= \delta_{\sigma \sigma'} \delta_{\nu \nu'}
    \quad (\sigma = 1, \dots, m_{\alpha}, \nu = 1, \dots, d_{\alpha}) \\\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span> labels real eigenvalues <span class="math notranslate nohighlight">\(\omega_{\alpha s}^{2}\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span> labels degenerated eigenvectors.
Here, <strong>we assume each equivalent irrep <span class="math notranslate nohighlight">\(\Gamma^{\mathbf{q}\alpha \sigma}\)</span> gives a different eigenvalue</strong>.
Also, we choice eigenvectors <span class="math notranslate nohighlight">\(\mathbf{c}(\mathbf{q} \alpha s\lambda) := \{ c(\mathbf{q}\alpha s\lambda)_{\sigma\nu} \}_{\sigma\nu}\)</span> are mutually orthogonal even within degenerated eigenvalues.</p>
<p>When irrep <span class="math notranslate nohighlight">\(\alpha\)</span> appears more than once (<span class="math notranslate nohighlight">\(m_{\alpha} &gt; 1\)</span>), irrep formed by eigenvectors is no longer same as <span class="math notranslate nohighlight">\(\Gamma^{\mathbf{q}\alpha}\)</span> <span id="id5">[<a class="reference internal" href="#id8" title="A. A. MARADUDIN and S. H. VOSKO. Symmetry properties of the normal vibrations of a crystal. Rev. Mod. Phys., 40:1–37, Jan 1968. URL: https://link.aps.org/doi/10.1103/RevModPhys.40.1, doi:10.1103/RevModPhys.40.1.">MV68</a>]</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \tilde{\mathbf{f}}(\mathbf{q}\alpha s \lambda)
    &amp;:= \sum_{\sigma\nu} \mathbf{f}(\mathbf{q}\alpha \sigma \nu) c(\mathbf{q}\alpha s\lambda)_{\sigma \nu} \\
  h \tilde{\mathbf{f}}(\mathbf{q}\alpha s \lambda)
    &amp;= \sum_{\lambda'} \tilde{\mathbf{f}}(\mathbf{q}\alpha s\lambda') \tilde{\Gamma}^{\mathbf{q}\alpha s}(h)_{\lambda'\lambda},\end{split}\]</div>
<p>where <a class="footnote-reference brackets" href="#eigmode-rep" id="id6">4</a></p>
<div class="math notranslate nohighlight">
\[  \tilde{\Gamma}^{\mathbf{q}\alpha s}(h)_{\lambda'\lambda}
    := \sum_{\sigma\nu\nu'} c(\mathbf{q}\alpha s\lambda')_{\sigma\nu'}^{\ast} \Gamma^{\mathbf{q}\alpha}(h)_{\nu'\nu} c(\mathbf{q}\alpha s\lambda)_{\sigma\nu}
    \quad (h \in \mathcal{G}^{\mathbf{q}}).\]</div>
<p>Now go back to the other convention of dynamical matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  e_{\mu}(\kappa; \mathbf{q}\alpha s \lambda)
    &amp;:= e^{ -i\mathbf{q} \cdot \mathbf{r}(0\kappa) } \tilde{f}_{\mu}(\kappa; \mathbf{q}\alpha s \lambda) \\
  D_{\mu\mu'}(\kappa\kappa'; \mathbf{q})
    &amp;= e^{ i \mathbf{q} \cdot \left( \mathbf{r}(0\kappa') - \mathbf{r}(0\kappa) \right) } \Phi_{\mu\mu'}(\kappa\kappa'; \mathbf{q}) \\
  \sum_{ \kappa'\mu' } D_{\mu\mu'}(\kappa\kappa'; \mathbf{q}) e_{\mu'}(\kappa'; \mathbf{q}\alpha s\lambda)
    &amp;= \omega_{\alpha s}^{2} e_{\mu}(\kappa; \mathbf{q}\alpha s \lambda) \\
  h \mathbf{e}(\mathbf{q}\alpha s \lambda)
    &amp;= \sum_{\lambda'} \mathbf{e}(\mathbf{q}\alpha s'\lambda') \tilde{\Gamma}^{\mathbf{q}\alpha s}(h)_{\lambda'\lambda}
    \quad (h \in \mathcal{G}^{\mathbf{q}}).\end{split}\]</div>
</section>
<section id="modulation">
<h2>Modulation<a class="headerlink" href="#modulation" title="Permalink to this headline">#</a></h2>
<p>Modulation associated with qpoint <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> and frequency <span class="math notranslate nohighlight">\(\mathbf{\omega}_{\mathbf{q}}\)</span>:</p>
<p><span class="math notranslate nohighlight">\(\mathbf{q} \neq \mathbf{0}\)</span> case:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  u^{( \mathbf{q} \alpha s)}_{\mu}(l\kappa)
    &amp;= \frac{1}{\sqrt{L^{3}M_{\kappa}}} \sum_{ \lambda }
      \left(
        Q^{ (\mathbf{q} \alpha s) }_{\lambda} e_{\mu}(\kappa; \mathbf{q} \alpha s \lambda) e^{ i \mathbf{q} \cdot \mathbf{r}(l\kappa) }
        + \mathrm{c.c.}
      \right) \\
  Q^{ (\mathbf{q} \alpha s) }_{\lambda} &amp;\in \mathbb{C} \\\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\mathbf{q} = \mathbf{0}\)</span> case:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  u^{( \mathbf{0} \alpha s)}_{\mu}(l\kappa)
    &amp;= \frac{1}{\sqrt{L^{3}M_{\kappa}}} \sum_{ \lambda }
        Q^{ (\mathbf{0} \alpha s) }_{\lambda} e_{\mu}(\kappa; \mathbf{0} \alpha s \lambda ) \\
  Q^{ (\mathbf{0} \alpha s) }_{\lambda} &amp;\in \mathbb{R} \\\end{split}\]</div>
<p>From unitary arbitrariness of <span class="math notranslate nohighlight">\(\tilde{\Gamma}^{\mathbf{q}\alpha s}\)</span>, we can choose as <span class="math notranslate nohighlight">\(\mathrm{Im}\, Q^{ (\mathbf{q} \alpha s) }_{\lambda=1} = 0\)</span>.
Thus, sampling of <span class="math notranslate nohighlight">\(\mathbf{Q}^{ (\mathbf{q} \alpha s) }\)</span> is attributed to sampling points from unit sphere <span class="math notranslate nohighlight">\(S^{2 d_{\alpha} - 2}\)</span>.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<div class="docutils container" id="id7">
<dl class="citation">
<dt class="label" id="id8"><span class="brackets">MV68</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id5">2</a>)</span></dt>
<dd><p>A. A. MARADUDIN and S. H. VOSKO. Symmetry properties of the normal vibrations of a crystal. <em>Rev. Mod. Phys.</em>, 40:1–37, Jan 1968. URL: <a class="reference external" href="https://link.aps.org/doi/10.1103/RevModPhys.40.1">https://link.aps.org/doi/10.1103/RevModPhys.40.1</a>, <a class="reference external" href="https://doi.org/10.1103/RevModPhys.40.1">doi:10.1103/RevModPhys.40.1</a>.</p>
</dd>
</dl>
</div>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="dynamical-matrix"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>This is the same phase convention with <a class="reference external" href="https://phonopy.github.io/phonopy/formulation.html#dynamical-matrix">phonopy</a>.
There is the other formulation for defining dynamical matrix as</p>
<div class="math notranslate nohighlight">
\[\Psi_{\mu \mu'}(\kappa\kappa'; \mathbf{q})
  = \frac{1}{ \sqrt{ M_{\kappa} M_{\kappa'} } } \sum_{l'} \Phi_{ \mu \mu' }(0\kappa, l'\kappa') e^{i \mathbf{q} \cdot \mathbf{r}(l')}.\]</div>
</dd>
<dt class="label" id="displacement-action"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>This definition actually satisfies the condition of left group action</p>
<div class="math notranslate nohighlight">
\[\begin{split}    \left[ g \left( g' \mathbf{u}(\mathbf{r}(l\kappa)) \right) \right]_{\mu}
    &amp;= \left[ g \left\{ \sum_{\nu} R_{g', \mu'\nu} u_{\nu}( g'\mathbf{r}(l\kappa) ) \right\}_{\mu'} \right]_{\mu} \\
    &amp;= \sum_{ \mu'\nu } R_{g, \mu\mu'} R_{g', \mu'\nu} u_{\nu}( gg'\mathbf{r}(l\kappa) ) \\
    &amp;= \sum_{ \nu } R_{gg', \mu\nu} u_{\nu}( gg'\mathbf{r}(l\kappa) ) \\
    &amp;= \left[ (gg') \mathbf{u}(\mathbf{r}(l\kappa)) \right]_{\mu}.\end{split}\]</div>
</dd>
<dt class="label" id="fourier-force-constant"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>The derivation is as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\sum_{ l\kappa\mu l'\kappa'\mu' } \Phi_{ \mu \mu' }(l\kappa, l'\kappa') u_{\mu}(l\kappa) u_{\mu'}(l'\kappa')
&amp;= \sum_{ l\kappa\mu l'\kappa'\mu' } \Phi_{ \mu \mu' }(l\kappa, l'\kappa') gu_{\mu}(l\kappa) gu_{\mu'}(l'\kappa') \\
&amp;= \dots = \sum_{  } \left[ \mathbf{\Gamma}^{\mathbf{q}}(g) \mathbf{\Phi}(\mathbf{q}) \mathbf{\Gamma}^{\mathbf{q}}(g)^{\dagger} \right]_{\kappa\mu, \kappa'\mu'} u_{\mu}(\kappa; \mathbf{R}_{g}\mathbf{q}) u_{\mu'}(\kappa'; -\mathbf{R}_{g}\mathbf{q}).\end{split}\]</div>
</dd>
<dt class="label" id="eigmode-rep"><span class="brackets"><a class="fn-backref" href="#id6">4</a></span></dt>
<dd><p>The derivation is cumbersome (to me).
Let <span class="math notranslate nohighlight">\(\mathbf{C}^{\mathbf{q}\alpha s} = ( \mathbf{c}(\mathbf{q}\alpha s 1), \dots, \mathbf{c}(\mathbf{q}\alpha s d_{\alpha}) )\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\tilde{\mathbf{\Gamma}}^{\alpha s}(h)
  &amp;:= \mathbf{C}^{\mathbf{q}\alpha s}
     \begin{pmatrix}
      \mathbf{\Gamma}^{\mathbf{q}\alpha}(h) &amp; &amp; \\
      &amp; \ddots &amp; \\
      &amp; &amp; \mathbf{\Gamma}^{\mathbf{q}\alpha}(h) \\
     \end{pmatrix}
     \mathbf{C}^{\mathbf{q}\alpha s \dagger} \\
\tilde{\Gamma}^{\alpha s}(h)_{\lambda' \lambda}
  &amp;= \sum_{\sigma' \nu' \sigma \nu}
        c(\mathbf{q}\alpha s \lambda')_{\sigma'\nu'}^{\ast} \delta_{\sigma \sigma'}
        \Gamma^{\mathbf{q}\alpha}(h)_{\nu'\nu}
        c(\mathbf{q}\alpha s \lambda)_{\sigma\nu} \\
  &amp;= \sum_{\sigma \nu' \nu}
        c(\mathbf{q}\alpha s \lambda')_{\sigma\nu'}^{\ast}
        \Gamma^{\mathbf{q}\alpha}(h)_{\nu'\nu}
        c(\mathbf{q}\alpha s \lambda)_{\sigma\nu} \\\end{split}\]</div>
</dd>
</dl>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="formulation.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Formulation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="isotropy_subgroup.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Isotropy subgroup</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Kohei Shinohara<br/>
  
      &copy; Copyright 2022, Kohei Shinohara.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>